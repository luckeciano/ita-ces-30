--------------------------------------------------------
--  Arquivo criado - Sexta-feira-Agosto-25-2017   
--------------------------------------------------------
REM INSERTING into LUCKECIANO.CLIENTE
SET DEFINE OFF;
Insert into LUCKECIANO.CLIENTE (CLI_CPF,CLI_NOME,CLI_ENDERECO,CLI_FONE) values ('63849380','Miguel','Rua H8A, 113','983948323');
Insert into LUCKECIANO.CLIENTE (CLI_CPF,CLI_NOME,CLI_ENDERECO,CLI_FONE) values ('93849430','Carlos','Rua Exemplo, 32','98483932');
Insert into LUCKECIANO.CLIENTE (CLI_CPF,CLI_NOME,CLI_ENDERECO,CLI_FONE) values ('8483927','Lucas','Rua Marechal Eduardo Gomes, 50','984739283');
Insert into LUCKECIANO.CLIENTE (CLI_CPF,CLI_NOME,CLI_ENDERECO,CLI_FONE) values ('12283930','Victor','Rua Curitiba, 1995','994839283');
Insert into LUCKECIANO.CLIENTE (CLI_CPF,CLI_NOME,CLI_ENDERECO,CLI_FONE) values ('8493238','Tercio','Rua Fortaleza, 66','93847392');
REM INSERTING into LUCKECIANO.CONTATO
SET DEFINE OFF;
Insert into LUCKECIANO.CONTATO (CON_COD,CON_CPF_CLIENTE,CON_NOME) values ('1','63849380','Adrriel');
Insert into LUCKECIANO.CONTATO (CON_COD,CON_CPF_CLIENTE,CON_NOME) values ('2','93849430','Karen');
Insert into LUCKECIANO.CONTATO (CON_COD,CON_CPF_CLIENTE,CON_NOME) values ('3','8483927','David');
Insert into LUCKECIANO.CONTATO (CON_COD,CON_CPF_CLIENTE,CON_NOME) values ('4','12283930','Mauro');
Insert into LUCKECIANO.CONTATO (CON_COD,CON_CPF_CLIENTE,CON_NOME) values ('5','8493238','Perotti');
REM INSERTING into LUCKECIANO.GRUPO
SET DEFINE OFF;
Insert into LUCKECIANO.GRUPO (GRU_CODIGO,GRU_NOME,GRU_IPI) values ('1','Eletronico','100');
Insert into LUCKECIANO.GRUPO (GRU_CODIGO,GRU_NOME,GRU_IPI) values ('2','Alimento','0');
Insert into LUCKECIANO.GRUPO (GRU_CODIGO,GRU_NOME,GRU_IPI) values ('3','Usado','50');
REM INSERTING into LUCKECIANO.ITEM_PEDIDO
SET DEFINE OFF;
Insert into LUCKECIANO.ITEM_PEDIDO (ITE_NUMERO,ITE_NUMERO_PEDIDO,ITE_COD_PRODUTO,ITE_QUANTIDADE,ITE_VALOR_VENDA) values ('1','999','1','2','6000');
Insert into LUCKECIANO.ITEM_PEDIDO (ITE_NUMERO,ITE_NUMERO_PEDIDO,ITE_COD_PRODUTO,ITE_QUANTIDADE,ITE_VALOR_VENDA) values ('2','998','2','1','2500');
Insert into LUCKECIANO.ITEM_PEDIDO (ITE_NUMERO,ITE_NUMERO_PEDIDO,ITE_COD_PRODUTO,ITE_QUANTIDADE,ITE_VALOR_VENDA) values ('3','997','3','1','1500');
Insert into LUCKECIANO.ITEM_PEDIDO (ITE_NUMERO,ITE_NUMERO_PEDIDO,ITE_COD_PRODUTO,ITE_QUANTIDADE,ITE_VALOR_VENDA) values ('4','996','4','10','55');
Insert into LUCKECIANO.ITEM_PEDIDO (ITE_NUMERO,ITE_NUMERO_PEDIDO,ITE_COD_PRODUTO,ITE_QUANTIDADE,ITE_VALOR_VENDA) values ('5','995','5','10','33');
Insert into LUCKECIANO.ITEM_PEDIDO (ITE_NUMERO,ITE_NUMERO_PEDIDO,ITE_COD_PRODUTO,ITE_QUANTIDADE,ITE_VALOR_VENDA) values ('6','994','6','2','4,4');
Insert into LUCKECIANO.ITEM_PEDIDO (ITE_NUMERO,ITE_NUMERO_PEDIDO,ITE_COD_PRODUTO,ITE_QUANTIDADE,ITE_VALOR_VENDA) values ('7','995','7','1','270');
Insert into LUCKECIANO.ITEM_PEDIDO (ITE_NUMERO,ITE_NUMERO_PEDIDO,ITE_COD_PRODUTO,ITE_QUANTIDADE,ITE_VALOR_VENDA) values ('8','998','8','1','30,5');
Insert into LUCKECIANO.ITEM_PEDIDO (ITE_NUMERO,ITE_NUMERO_PEDIDO,ITE_COD_PRODUTO,ITE_QUANTIDADE,ITE_VALOR_VENDA) values ('9','998','9','1','15,9');
REM INSERTING into LUCKECIANO.PEDIDO
SET DEFINE OFF;
Insert into LUCKECIANO.PEDIDO (PED_NUMERO,PED_DATA,PED_DATA_ENTREGA,PED_CPF_CLIENTE) values ('999',to_date('01/07/17','DD/MM/RR'),to_date('01/07/17','DD/MM/RR'),'63849380');
Insert into LUCKECIANO.PEDIDO (PED_NUMERO,PED_DATA,PED_DATA_ENTREGA,PED_CPF_CLIENTE) values ('998',to_date('01/07/17','DD/MM/RR'),to_date('02/07/17','DD/MM/RR'),'93849430');
Insert into LUCKECIANO.PEDIDO (PED_NUMERO,PED_DATA,PED_DATA_ENTREGA,PED_CPF_CLIENTE) values ('997',to_date('01/07/17','DD/MM/RR'),to_date('03/07/17','DD/MM/RR'),'8483927');
Insert into LUCKECIANO.PEDIDO (PED_NUMERO,PED_DATA,PED_DATA_ENTREGA,PED_CPF_CLIENTE) values ('996',to_date('02/07/17','DD/MM/RR'),to_date('02/07/17','DD/MM/RR'),'12283930');
Insert into LUCKECIANO.PEDIDO (PED_NUMERO,PED_DATA,PED_DATA_ENTREGA,PED_CPF_CLIENTE) values ('995',to_date('03/07/17','DD/MM/RR'),to_date('04/07/17','DD/MM/RR'),'8493238');
Insert into LUCKECIANO.PEDIDO (PED_NUMERO,PED_DATA,PED_DATA_ENTREGA,PED_CPF_CLIENTE) values ('994',to_date('03/07/17','DD/MM/RR'),to_date('04/07/17','DD/MM/RR'),'93849430');
REM INSERTING into LUCKECIANO.PRODUTO
SET DEFINE OFF;
Insert into LUCKECIANO.PRODUTO (PRO_CODIGO,PRO_DESCRICAO,PRO_ESTOQUE,PRO_PRECO_BASE,PRO_CODIGO_GRUPO) values ('1','Samsung Galaxy S8','55','3000','1');
Insert into LUCKECIANO.PRODUTO (PRO_CODIGO,PRO_DESCRICAO,PRO_ESTOQUE,PRO_PRECO_BASE,PRO_CODIGO_GRUPO) values ('2','iPhone 5S','31','2500','1');
Insert into LUCKECIANO.PRODUTO (PRO_CODIGO,PRO_DESCRICAO,PRO_ESTOQUE,PRO_PRECO_BASE,PRO_CODIGO_GRUPO) values ('3','Geladeira Brastemp','7','1500','1');
Insert into LUCKECIANO.PRODUTO (PRO_CODIGO,PRO_DESCRICAO,PRO_ESTOQUE,PRO_PRECO_BASE,PRO_CODIGO_GRUPO) values ('4','Alface','33','5,5','2');
Insert into LUCKECIANO.PRODUTO (PRO_CODIGO,PRO_DESCRICAO,PRO_ESTOQUE,PRO_PRECO_BASE,PRO_CODIGO_GRUPO) values ('5','Tomate','150','3,3','2');
Insert into LUCKECIANO.PRODUTO (PRO_CODIGO,PRO_DESCRICAO,PRO_ESTOQUE,PRO_PRECO_BASE,PRO_CODIGO_GRUPO) values ('6','Cebola','40','2,2','2');
Insert into LUCKECIANO.PRODUTO (PRO_CODIGO,PRO_DESCRICAO,PRO_ESTOQUE,PRO_PRECO_BASE,PRO_CODIGO_GRUPO) values ('7','Bicicleta','4','270','3');
Insert into LUCKECIANO.PRODUTO (PRO_CODIGO,PRO_DESCRICAO,PRO_ESTOQUE,PRO_PRECO_BASE,PRO_CODIGO_GRUPO) values ('8','Bola','7','30,5','3');
Insert into LUCKECIANO.PRODUTO (PRO_CODIGO,PRO_DESCRICAO,PRO_ESTOQUE,PRO_PRECO_BASE,PRO_CODIGO_GRUPO) values ('9','Anzol','2','15,9','3');
REM INSERTING into LUCKECIANO.VENDA
SET DEFINE OFF;
Insert into LUCKECIANO.VENDA (VDA_CODIGO,VDA_NUMERO_PEDIDO,VDA_CODIGO_VENDEDOR) values ('1','999','1');
Insert into LUCKECIANO.VENDA (VDA_CODIGO,VDA_NUMERO_PEDIDO,VDA_CODIGO_VENDEDOR) values ('2','998','1');
Insert into LUCKECIANO.VENDA (VDA_CODIGO,VDA_NUMERO_PEDIDO,VDA_CODIGO_VENDEDOR) values ('3','997','2');
Insert into LUCKECIANO.VENDA (VDA_CODIGO,VDA_NUMERO_PEDIDO,VDA_CODIGO_VENDEDOR) values ('4','996','2');
Insert into LUCKECIANO.VENDA (VDA_CODIGO,VDA_NUMERO_PEDIDO,VDA_CODIGO_VENDEDOR) values ('5','995','3');
Insert into LUCKECIANO.VENDA (VDA_CODIGO,VDA_NUMERO_PEDIDO,VDA_CODIGO_VENDEDOR) values ('6','994','3');
REM INSERTING into LUCKECIANO.VENDEDOR
SET DEFINE OFF;
Insert into LUCKECIANO.VENDEDOR (VDR_CODIGO,VDR_NOME) values ('1','Jair');
Insert into LUCKECIANO.VENDEDOR (VDR_CODIGO,VDR_NOME) values ('2','Renato Silva');
Insert into LUCKECIANO.VENDEDOR (VDR_CODIGO,VDR_NOME) values ('3','Aristoteles');



--3.1
SELECT CLI.CLI_NOME, PED.PED_NUMERO, PED.PED_DATA, SOMA.TOTAL 
    FROM CLIENTE CLI, PEDIDO PED,  
    (SELECT PED.PED_NUMERO, SUM(ITE_VALOR_VENDA) AS TOTAL
    FROM PEDIDO PED, ITEM_PEDIDO ITE
    WHERE ITE.ITE_NUMERO_PEDIDO = PED.PED_NUMERO
    GROUP BY PED.PED_NUMERO) SOMA
WHERE CLI.CLI_NOME = 'Miguel' AND PED.PED_CPF_CLIENTE = CLI.CLI_CPF AND PED.PED_NUMERO = SOMA.PED_NUMERO

--3.2   
SELECT * 
    FROM CONTATO CONT,
    (SELECT CLI.CLI_CPF, CLI.CLI_NOME, PED.PED_NUMERO, PED.PED_DATA, SOMA.TOTAL
    FROM CLIENTE CLI, PEDIDO PED,
        (SELECT PED.PED_NUMERO, SUM(ITE.ITE_VALOR_VENDA) AS TOTAL
        FROM PEDIDO PED, ITEM_PEDIDO ITE
        WHERE PED.PED_NUMERO = ITE.ITE_NUMERO_PEDIDO
        GROUP BY PED.PED_NUMERO) SOMA
    WHERE PED.PED_CPF_CLIENTE = CLI.CLI_CPF AND PED.PED_NUMERO = SOMA.PED_NUMERO) SOMA
WHERE CONT.CON_CPF_CLIENTE = SOMA.CLI_CPF AND SOMA.TOTAL >= 1000;

--3.3
SELECT *
    FROM ITEM_PEDIDO ITE,
    (SELECT PED.PED_NUMERO, PED.PED_DATA, VDR.VDR_NOME
     FROM PEDIDO PED, VENDEDOR VDR, VENDA VND
     WHERE PED.PED_NUMERO = VND.VDA_NUMERO_PEDIDO AND VND.VDA_CODIGO_VENDEDOR = VDR.VDR_CODIGO) VENDA
WHERE ITE.ITE_NUMERO_PEDIDO = VENDA.PED_NUMERO AND VENDA.VDR_NOME = 'Renato Silva' AND VENDA.PED_DATA = '01/07/17';

--3.4
SELECT SUM(PRO_ESTOQUE) FROM PRODUTO WHERE PRO_CODIGO_GRUPO = 1;


--3.5
SELECT * FROM (SELECT PED.PED_NUMERO, JUNC.PRO_CODIGO_GRUPO 
        FROM PEDIDO PED, 
            (SELECT IPED.ITE_NUMERO_PEDIDO, PROD.PRO_CODIGO_GRUPO 
            FROM ITEM_PEDIDO IPED, PRODUTO PROD
            WHERE IPED.ITE_COD_PRODUTO = PROD.PRO_CODIGO) JUNC 
        WHERE PED.PED_NUMERO = JUNC.ITE_NUMERO_PEDIDO)
WHERE PRO_CODIGO_GRUPO = 1;

